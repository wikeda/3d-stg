# スペースハリアー風3Dシューティングゲーム 要件定義書

## 📌 プロジェクト概要

スペースハリアーにインスパイアされた、ブラウザで動作する3Dシューティングゲームを開発する。
ローポリゴン風のビジュアルで、明るく爽快感のあるゲーム体験を提供する。

### ターゲット
- デスクトップブラウザ（Chrome, Firefox, Safari, Edge）
- モバイルブラウザ（タッチ操作対応）

### 公開方法
- GitHub Pagesで公開

---

## 🛠 技術スタック

### コア技術
- **3Dライブラリ**: Three.js
- **開発言語**: TypeScript
- **ビルドツール**: Vite
- **デプロイ**: GitHub Pages

### 技術的考慮事項
- Viteの設定でGitHub Pages用のbaseパス設定
- レスポンシブ対応（デスクトップ・モバイル）
- パフォーマンス最適化（60fps維持）

---

## 📅 開発フェーズ

### フェーズ1: MVP（最小実装）
**目標**: 基本的なゲームループを完成させる

実装内容:
- ✅ 疑似3D視点（Three.jsパースペクティブカメラ）
- ✅ プレイヤー移動（上下左右）
- ✅ 敵の出現（2-3種類）
- ✅ シューティング（自動連射）
- ✅ 背景スクロール（チェッカーボード地面・星空）
- ✅ 障害物
- ✅ 衝突判定
- ✅ ライフシステム（HP: 5）
- ✅ ゲームオーバー画面
- ✅ UI枠（ライフ、ステージ番号、スコア枠のみ）

### フェーズ2: スコア・ステージシステム
**目標**: ゲームに深みを持たせる

実装内容:
- ✅ スコアシステム実装
- ✅ 5ステージ実装
- ✅ ステージクリア画面
- ✅ ステージ毎の背景・敵配置変更

### フェーズ3: ボス・パワーアップ
**目標**: ゲームの面白さを向上

実装内容:
- ✅ 各ステージにボスキャラクター（5体）
- ✅ パワーアップアイテム（レーザー、ライフ回復、無敵）
- ✅ タイトル画面（操作説明付き）
- ✅ ハイスコア保存（localStorage）

### フェーズ4: サウンド
**目標**: 完成度を高める

実装内容:
- ✅ 効果音（弾発射、敵破壊、ダメージ、アイテム取得、ボス登場）
- ✅ BGM（ステージ毎5曲、ボス戦、ゲームオーバー）
- ✅ 音源は自分で用意

---

## 🎮 機能要件詳細

### 1. プレイヤー仕様

#### 移動
- **移動範囲**: 画面全体（端まで移動可能）
- **移動速度**: 速め（スペースハリアー風）
- **操作方法**:
  - キーボード: WASD or 矢印キー
  - マウス: マウス移動
  - タッチ: タッチ&ドラッグ（モバイル対応）

#### 射撃
- **発射方法**: 自動連射（ボタン押しっぱなし）
  - キーボード: スペースキー
  - マウス: クリック
  - タッチ: 画面タッチ（移動と同時）
- **弾速**: 速い
- **同時発射数**: 最大5発まで

#### ライフ
- **初期HP**: 5
- **ダメージ**: 敵・障害物に当たるとHP-1
- **ゲームオーバー**: HP=0

---

### 2. 敵仕様

#### 敵の種類（2-3種類）

**タイプA: 直線型**
- 動き: 奥から手前へ直線的に移動
- 耐久力: 1発で撃破
- ビジュアル: シンプルな形状（例: 三角錐）

**タイプB: 左右移動型**
- 動き: 左右に揺れながら手前へ
- 耐久力: 2発で撃破
- ビジュアル: 少し複雑な形状

**タイプC: 追尾型**
- 動き: プレイヤーを狙って移動
- 耐久力: 3発で撃破
- ビジュアル: より複雑な形状

#### 出現システム
- **出現方式**: パターン化されたウェーブ形式
- **ウェーブ構成**: ステージ毎に異なる配置パターン
- **難易度上昇**: ゲーム進行に伴い敵の数・速度が増加

#### 破壊エフェクト
- 敵撃破時に爆発エフェクト（パーティクル）表示

---

### 3. 障害物仕様

#### 種類
- 複数種類の障害物を用意（岩、柱など）

#### 配置
- 地面に固定されたもの
- 空中に浮いているもの

#### 当たり判定
- プレイヤーが接触するとHP-1（敵と同じダメージ）

---

### 4. 背景・環境

#### 3D空間
- **カメラ**: Three.jsパースペクティブカメラ使用
- **遠近感**: Z座標により自動的にスケール変化（奥=小さい、手前=大きい）
- **視点**: 固定カメラ、世界が手前に流れてくる

#### 地面
- **パターン**: チェッカーボード（市松模様）
- **スクロール**: 手前に流れるアニメーション

#### 空
- **デザイン**: 星空
- **動き**: 緩やかなスクロールまたは固定

#### 地平線
- シンプルに地面と空の境界のみ（追加オブジェクトなし）

---

### 5. ボスキャラクター（フェーズ3）

#### 基本仕様
- **登場**: 全5ステージの最後に登場
- **サイズ**: 通常敵より大きい
- **耐久力**: 高い（複数回攻撃が必要）

#### 特徴
- 特殊な攻撃パターン
- 弱点部位あり（特定部位を狙う必要）
- ボス専用BGM

---

### 6. パワーアップ（フェーズ3）

#### アイテムの種類

**レーザー武器**
- 効果: 通常弾がレーザーに変化
- 特性: 貫通、高威力
- 持続: 一定時間 or 弾数制限

**ライフ回復**
- 効果: HP+1

**無敵時間**
- 効果: 一定時間ダメージを受けない
- ビジュアル: プレイヤーが点滅

#### 出現条件
- 敵撃破時に一定確率で出現
- アイテムは手前に流れてくる

---

### 7. UI/HUD

#### ゲーム中の表示

**常時表示:**
- 残りライフ（HP）: ハートアイコンまたは数値
- ステージ番号: "STAGE 1" など
- スコア: 数値表示（MVP時は枠のみ）

**非表示:**
- 残弾数
- FPS
- ミニマップ

#### タイトル画面（フェーズ3）
- ゲームタイトル
- STARTボタン
- ハイスコア表示
- 操作説明

#### ゲームオーバー画面
- "GAME OVER" 表示
- 最終スコア、到達ステージなどの結果表示
- リトライボタン

#### ステージクリア画面（フェーズ2）
- "STAGE CLEAR" 表示
- ステージ結果表示（スコア、撃破数など）
- 次ステージへボタン

---

### 8. スコアシステム（フェーズ2）

#### 得点方式
- 敵撃破: 敵の種類・耐久力に応じてポイント
- ボス撃破: 高得点
- ステージクリア: ボーナスポイント

#### ハイスコア（フェーズ3）
- localStorage保存（ブラウザローカル）
- タイトル画面に表示

---

### 9. ステージシステム（フェーズ2）

#### ステージ数
- 全5ステージ

#### ステージ毎の変化
- 背景の色・見た目
- 敵の種類・配置パターン
- 難易度（敵の数・速度）
- BGM（各ステージ固有）

#### ステージ構成例
- Stage 1: チュートリアル的な易しい難易度
- Stage 2-4: 徐々に難易度上昇
- Stage 5: 最高難易度

---

### 10. サウンド/BGM（フェーズ4）

#### 効果音
- 弾発射音
- 敵破壊音
- ダメージ音
- アイテム取得音
- ボス登場音

#### BGM
- ステージBGM（5曲、各ステージ固有）
- ボス戦BGM
- ゲームオーバーBGM

#### 音源
- 自分で用意する

---

## 🎨 ビジュアル仕様

### グラフィックスタイル
- **方向性**: ローポリゴン風
- **シェーディング**: フラットシェーディング
- **雰囲気**: スペースハリアー風（明るい色使い、ポップ）

### カラーパレット
- 明るい色調
- ビビッドな配色
- 青空、鮮やかな地面

### 3Dモデル
- シンプルだが形にこだわる
- ローポリゴン
- テクスチャは最小限

---

## ⚙️ 技術仕様

### ディレクトリ構成（案）

```
3d-stg/
├── src/
│   ├── main.ts                 # エントリーポイント
│   ├── game/
│   │   ├── Game.ts             # ゲームメインループ
│   │   ├── Player.ts           # プレイヤークラス
│   │   ├── Enemy.ts            # 敵基底クラス
│   │   ├── EnemyTypeA.ts       # 敵タイプA
│   │   ├── EnemyTypeB.ts       # 敵タイプB
│   │   ├── EnemyTypeC.ts       # 敵タイプC
│   │   ├── Bullet.ts           # 弾クラス
│   │   ├── Obstacle.ts         # 障害物クラス
│   │   ├── Boss.ts             # ボスクラス
│   │   ├── PowerUp.ts          # パワーアップアイテム
│   │   └── Stage.ts            # ステージ管理
│   ├── scene/
│   │   ├── SceneManager.ts     # シーン管理
│   │   ├── Background.ts       # 背景（地面・空）
│   │   └── Camera.ts           # カメラ設定
│   ├── ui/
│   │   ├── HUD.ts              # ゲーム中UI
│   │   ├── TitleScreen.ts      # タイトル画面
│   │   ├── GameOverScreen.ts   # ゲームオーバー画面
│   │   └── StageClearScreen.ts # ステージクリア画面
│   ├── input/
│   │   └── InputManager.ts     # 入力管理（キーボード・マウス・タッチ）
│   ├── audio/
│   │   └── AudioManager.ts     # サウンド管理
│   ├── utils/
│   │   ├── CollisionDetector.ts # 衝突判定
│   │   └── ScoreManager.ts      # スコア管理
│   └── types/
│       └── index.ts            # 型定義
├── public/
│   ├── assets/
│   │   ├── audio/              # 音声ファイル
│   │   └── models/             # 3Dモデル（必要に応じて）
├── index.html
├── package.json
├── tsconfig.json
├── vite.config.ts
└── README.md
```

### パフォーマンス要件
- **フレームレート**: 60fps維持
- **ローディング時間**: 5秒以内（初回読み込み）
- **メモリ使用量**: 適切なオブジェクトプール実装

### GitHub Pages設定

**vite.config.ts設定例:**
```typescript
import { defineConfig } from 'vite'

export default defineConfig({
  base: '/3d-stg/', // リポジトリ名に合わせる
  build: {
    outDir: 'dist',
  }
})
```

**デプロイフロー:**
1. `npm run build` でビルド
2. `dist/` フォルダをGitHub Pagesで公開
3. GitHub Actions自動デプロイ設定（推奨）

---

## 🎯 ゲームバランス

### 難易度設定

**序盤（Stage 1-2）:**
- 敵の数: 少なめ
- 敵の速度: 遅め
- シンプルな敵配置パターン

**中盤（Stage 3-4）:**
- 敵の数: 増加
- 敵の速度: やや速く
- 複雑な配置パターン

**終盤（Stage 5）:**
- 敵の数: 最大
- 敵の速度: 速い
- 高難易度のパターン

### プレイ時間目安
- 1ステージ: 2-3分
- 全クリア: 10-15分

---

## 📝 実装優先順位

### 実装順序
1. **疑似3D視点** - カメラ・基本シーン構築
2. **プレイヤー移動** - 入力処理・移動制御
3. **敵の出現** - 敵生成・移動ロジック
4. **シューティング** - 弾発射・衝突判定
5. **背景スクロール** - 地面・空の実装
6. **障害物** - 障害物配置・衝突

この順序でMVPを完成させ、その後フェーズ2以降を実装する。

---

## ✅ 完成条件

### MVP完成条件
- [ ] 基本的なゲームループが動作
- [ ] プレイヤー操作が快適
- [ ] 敵との戦闘が成立
- [ ] ゲームオーバーまでの流れが完成
- [ ] デスクトップ・モバイル両対応
- [ ] GitHub Pagesで公開可能

### 最終完成条件
- [ ] 全5ステージ実装
- [ ] 全ボス実装
- [ ] サウンド実装
- [ ] バグ修正完了
- [ ] パフォーマンス最適化完了

---

## 📚 参考資料

### Three.js公式
- https://threejs.org/

### 参考ゲーム
- スペースハリアー（SEGA）

---

**作成日**: 2025-11-30
**バージョン**: 1.0
