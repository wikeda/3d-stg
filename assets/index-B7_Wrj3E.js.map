{"version":3,"file":"index-B7_Wrj3E.js","sources":["../../src/scene/SceneManager.ts","../../src/scene/Background.ts","../../src/input/InputManager.ts","../../src/game/Player.ts","../../src/game/Bullet.ts","../../src/game/Enemy.ts","../../src/game/EnemyTypeA.ts","../../src/game/EnemyTypeB.ts","../../src/game/EnemyTypeC.ts","../../src/game/Obstacle.ts","../../src/utils/CollisionDetector.ts","../../src/utils/ScoreManager.ts","../../src/ui/HUD.ts","../../src/ui/GameOverScreen.ts","../../src/ui/StageClearScreen.ts","../../src/game/StageData.ts","../../src/game/Game.ts","../../src/main.ts"],"sourcesContent":["import * as THREE from 'three'\r\n\r\nexport class SceneManager {\r\n  private scene: THREE.Scene\r\n  private camera: THREE.PerspectiveCamera\r\n  private renderer: THREE.WebGLRenderer\r\n\r\n  constructor() {\r\n    this.scene = new THREE.Scene()\r\n    this.camera = this.createCamera()\r\n    this.renderer = this.createRenderer()\r\n    this.setupLights()\r\n    this.handleResize()\r\n  }\r\n\r\n  private createCamera(): THREE.PerspectiveCamera {\r\n    const camera = new THREE.PerspectiveCamera(\r\n      75,\r\n      window.innerWidth / window.innerHeight,\r\n      0.1,\r\n      1000\r\n    )\r\n    camera.position.set(0, 5, 10)\r\n    camera.lookAt(0, 0, -50)\r\n    return camera\r\n  }\r\n\r\n  private createRenderer(): THREE.WebGLRenderer {\r\n    const renderer = new THREE.WebGLRenderer({ antialias: true })\r\n    renderer.setSize(window.innerWidth, window.innerHeight)\r\n    renderer.setPixelRatio(window.devicePixelRatio)\r\n    renderer.shadowMap.enabled = true\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap\r\n    const container = document.getElementById('game-container')\r\n    if (container) {\r\n      container.appendChild(renderer.domElement)\r\n    }\r\n    return renderer\r\n  }\r\n\r\n  private setupLights(): void {\r\n    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6)\r\n    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8)\r\n    directionalLight.position.set(10, 20, 10)\r\n    directionalLight.castShadow = true\r\n\r\n    // Shadow camera settings\r\n    directionalLight.shadow.camera.left = -50\r\n    directionalLight.shadow.camera.right = 50\r\n    directionalLight.shadow.camera.top = 50\r\n    directionalLight.shadow.camera.bottom = -50\r\n    directionalLight.shadow.camera.near = 0.5\r\n    directionalLight.shadow.camera.far = 500\r\n    directionalLight.shadow.mapSize.width = 2048\r\n    directionalLight.shadow.mapSize.height = 2048\r\n\r\n    this.scene.add(ambientLight, directionalLight)\r\n  }\r\n\r\n  private handleResize(): void {\r\n    window.addEventListener('resize', () => {\r\n      this.camera.aspect = window.innerWidth / window.innerHeight\r\n      this.camera.updateProjectionMatrix()\r\n      this.renderer.setSize(window.innerWidth, window.innerHeight)\r\n    })\r\n  }\r\n\r\n  getScene(): THREE.Scene {\r\n    return this.scene\r\n  }\r\n\r\n  getCamera(): THREE.PerspectiveCamera {\r\n    return this.camera\r\n  }\r\n\r\n  getRenderer(): THREE.WebGLRenderer {\r\n    return this.renderer\r\n  }\r\n\r\n  render(): void {\r\n    this.renderer.render(this.scene, this.camera)\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\n\r\nexport class Background {\r\n  private ground: THREE.Mesh\r\n  private stars: THREE.Points\r\n  private scrollSpeed: number = 0.5\r\n  private groundCanvas: HTMLCanvasElement\r\n\r\n  constructor(scene: THREE.Scene) {\r\n    this.groundCanvas = document.createElement('canvas')\r\n    this.ground = this.createGround('#00ff00', '#00aa00')\r\n    this.stars = this.createStars()\r\n    scene.add(this.ground, this.stars)\r\n  }\r\n\r\n  private createGround(color1: string = '#00ff00', color2: string = '#00aa00'): THREE.Mesh {\r\n    const geometry = new THREE.PlaneGeometry(100, 500, 10, 50)\r\n\r\n    // Create checkerboard texture\r\n    this.groundCanvas.width = 256\r\n    this.groundCanvas.height = 256\r\n    const ctx = this.groundCanvas.getContext('2d')!\r\n    const tileSize = 32\r\n\r\n    for (let y = 0; y < 256; y += tileSize) {\r\n      for (let x = 0; x < 256; x += tileSize) {\r\n        ctx.fillStyle = ((x / tileSize) + (y / tileSize)) % 2 === 0 ? color1 : color2\r\n        ctx.fillRect(x, y, tileSize, tileSize)\r\n      }\r\n    }\r\n\r\n    const texture = new THREE.CanvasTexture(this.groundCanvas)\r\n    texture.wrapS = THREE.RepeatWrapping\r\n    texture.wrapT = THREE.RepeatWrapping\r\n    texture.repeat.set(5, 25)\r\n\r\n    const material = new THREE.MeshStandardMaterial({\r\n      map: texture,\r\n      side: THREE.DoubleSide\r\n    })\r\n\r\n    const ground = new THREE.Mesh(geometry, material)\r\n    ground.rotation.x = -Math.PI / 2\r\n    ground.position.y = -5\r\n    ground.position.z = -250\r\n    ground.receiveShadow = true\r\n\r\n    return ground\r\n  }\r\n\r\n  updateGroundColors(color1: string, color2: string): void {\r\n    const ctx = this.groundCanvas.getContext('2d')!\r\n    const tileSize = 32\r\n\r\n    for (let y = 0; y < 256; y += tileSize) {\r\n      for (let x = 0; x < 256; x += tileSize) {\r\n        ctx.fillStyle = ((x / tileSize) + (y / tileSize)) % 2 === 0 ? color1 : color2\r\n        ctx.fillRect(x, y, tileSize, tileSize)\r\n      }\r\n    }\r\n\r\n    const material = this.ground.material as THREE.MeshStandardMaterial\r\n    if (material.map) {\r\n      material.map.needsUpdate = true\r\n    }\r\n  }\r\n\r\n  private createStars(): THREE.Points {\r\n    const geometry = new THREE.BufferGeometry()\r\n    const vertices: number[] = []\r\n\r\n    for (let i = 0; i < 1000; i++) {\r\n      vertices.push(\r\n        THREE.MathUtils.randFloatSpread(200),\r\n        THREE.MathUtils.randFloat(10, 50), // Changed from 0 to 10 to avoid ground clipping\r\n        THREE.MathUtils.randFloatSpread(500)\r\n      )\r\n    }\r\n\r\n    geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3))\r\n    const material = new THREE.PointsMaterial({ color: 0xffffff, size: 0.5 })\r\n\r\n    return new THREE.Points(geometry, material)\r\n  }\r\n\r\n  update(deltaTime: number): void {\r\n    // Ground scrolling (positive to move towards player)\r\n    const material = this.ground.material as THREE.MeshStandardMaterial\r\n    if (material.map) {\r\n      material.map.offset.y += this.scrollSpeed * deltaTime\r\n    }\r\n  }\r\n}\r\n","export interface InputState {\r\n  moveX: number  // -1 to 1\r\n  moveY: number  // -1 to 1\r\n  shoot: boolean\r\n}\r\n\r\nexport class InputManager {\r\n  private keys: Set<string> = new Set()\r\n  private mousePos: { x: number; y: number } = { x: 0, y: 0 }\r\n  private mouseDown: boolean = false\r\n  private touchPos: { x: number; y: number } | null = null\r\n  private inputMode: 'keyboard' | 'mouse' | 'touch' = 'keyboard'\r\n\r\n  constructor() {\r\n    this.setupEventListeners()\r\n  }\r\n\r\n  private setupEventListeners(): void {\r\n    // Keyboard\r\n    window.addEventListener('keydown', (e) => this.keys.add(e.key))\r\n    window.addEventListener('keyup', (e) => this.keys.delete(e.key))\r\n\r\n    // Mouse\r\n    window.addEventListener('mousemove', (e) => {\r\n      this.inputMode = 'mouse'\r\n      this.mousePos.x = (e.clientX / window.innerWidth) * 2 - 1\r\n      this.mousePos.y = -(e.clientY / window.innerHeight) * 2 + 1\r\n    })\r\n    window.addEventListener('mousedown', () => this.mouseDown = true)\r\n    window.addEventListener('mouseup', () => this.mouseDown = false)\r\n\r\n    // Touch\r\n    window.addEventListener('touchstart', (e) => {\r\n      this.inputMode = 'touch'\r\n      const touch = e.touches[0]\r\n      this.touchPos = {\r\n        x: (touch.clientX / window.innerWidth) * 2 - 1,\r\n        y: -(touch.clientY / window.innerHeight) * 2 + 1\r\n      }\r\n    })\r\n    window.addEventListener('touchmove', (e) => {\r\n      const touch = e.touches[0]\r\n      this.touchPos = {\r\n        x: (touch.clientX / window.innerWidth) * 2 - 1,\r\n        y: -(touch.clientY / window.innerHeight) * 2 + 1\r\n      }\r\n    })\r\n    window.addEventListener('touchend', () => this.touchPos = null)\r\n  }\r\n\r\n  getInputState(): InputState {\r\n    const state: InputState = { moveX: 0, moveY: 0, shoot: false }\r\n\r\n    if (this.inputMode === 'keyboard') {\r\n      if (this.keys.has('ArrowLeft') || this.keys.has('a') || this.keys.has('A')) state.moveX -= 1\r\n      if (this.keys.has('ArrowRight') || this.keys.has('d') || this.keys.has('D')) state.moveX += 1\r\n      if (this.keys.has('ArrowUp') || this.keys.has('w') || this.keys.has('W')) state.moveY += 1\r\n      if (this.keys.has('ArrowDown') || this.keys.has('s') || this.keys.has('S')) state.moveY -= 1\r\n      if (this.keys.has(' ')) state.shoot = true\r\n    } else if (this.inputMode === 'mouse') {\r\n      state.moveX = this.mousePos.x\r\n      state.moveY = this.mousePos.y\r\n      state.shoot = this.mouseDown\r\n    } else if (this.inputMode === 'touch' && this.touchPos) {\r\n      state.moveX = this.touchPos.x\r\n      state.moveY = this.touchPos.y\r\n      state.shoot = true\r\n    }\r\n\r\n    return state\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\nimport { InputState } from '../input/InputManager'\r\n\r\nexport class Player {\r\n  private mesh: THREE.Mesh\r\n  private hp: number = 5\r\n  private maxHp: number = 5\r\n  private speed: number = 15\r\n  private bounds = { x: 12, y: 8 }\r\n  private invincible: boolean = false\r\n  private invincibleTime: number = 0\r\n  private shootCooldown: number = 0\r\n  private shootInterval: number = 0.15 // seconds between shots\r\n  private magazineSize: number = 7\r\n  private currentMagazine: number = 7\r\n  private reloadTime: number = 0.7 // seconds to reload\r\n  private reloading: boolean = false\r\n  private reloadTimer: number = 0\r\n\r\n  constructor(scene: THREE.Scene) {\r\n    this.mesh = this.createMesh()\r\n    scene.add(this.mesh)\r\n  }\r\n\r\n  private createMesh(): THREE.Mesh {\r\n    const geometry = new THREE.ConeGeometry(0.5, 1.5, 3)\r\n    const material = new THREE.MeshStandardMaterial({\r\n      color: 0x00ffff,\r\n      flatShading: true,\r\n      transparent: true,\r\n      opacity: 1\r\n    })\r\n    const mesh = new THREE.Mesh(geometry, material)\r\n    mesh.rotation.x = Math.PI / 2\r\n    mesh.position.set(0, 0, 0)\r\n    mesh.castShadow = true\r\n    return mesh\r\n  }\r\n\r\n  update(deltaTime: number, input: InputState): void {\r\n    // Movement\r\n    if (input.moveX !== 0 || input.moveY !== 0) {\r\n      const targetX = input.moveX * this.bounds.x\r\n      const targetY = input.moveY * this.bounds.y\r\n\r\n      this.mesh.position.x += (targetX - this.mesh.position.x) * this.speed * deltaTime\r\n      this.mesh.position.y += (targetY - this.mesh.position.y) * this.speed * deltaTime\r\n    }\r\n\r\n    // Boundary limits\r\n    this.mesh.position.x = THREE.MathUtils.clamp(this.mesh.position.x, -this.bounds.x, this.bounds.x)\r\n    this.mesh.position.y = THREE.MathUtils.clamp(this.mesh.position.y, -this.bounds.y, this.bounds.y)\r\n\r\n    // Invincibility update\r\n    if (this.invincible) {\r\n      this.invincibleTime -= deltaTime\r\n      if (this.invincibleTime <= 0) {\r\n        this.invincible = false\r\n        const material = this.mesh.material as THREE.MeshStandardMaterial\r\n        material.opacity = 1\r\n      } else {\r\n        // Blinking effect\r\n        const material = this.mesh.material as THREE.MeshStandardMaterial\r\n        material.opacity = Math.sin(this.invincibleTime * 20) * 0.5 + 0.5\r\n      }\r\n    }\r\n\r\n    // Shoot cooldown\r\n    if (this.shootCooldown > 0) {\r\n      this.shootCooldown -= deltaTime\r\n    }\r\n\r\n    // Reload timer\r\n    if (this.reloading) {\r\n      this.reloadTimer -= deltaTime\r\n      if (this.reloadTimer <= 0) {\r\n        this.reloading = false\r\n        this.currentMagazine = this.magazineSize\r\n      }\r\n    }\r\n  }\r\n\r\n  canShoot(): boolean {\r\n    return this.shootCooldown <= 0 && !this.reloading && this.currentMagazine > 0\r\n  }\r\n\r\n  resetShootCooldown(): void {\r\n    this.shootCooldown = this.shootInterval\r\n    this.currentMagazine--\r\n\r\n    // Auto reload when magazine is empty\r\n    if (this.currentMagazine <= 0 && !this.reloading) {\r\n      this.startReload()\r\n    }\r\n  }\r\n\r\n  private startReload(): void {\r\n    this.reloading = true\r\n    this.reloadTimer = this.reloadTime\r\n  }\r\n\r\n  isReloading(): boolean {\r\n    return this.reloading\r\n  }\r\n\r\n  getCurrentMagazine(): number {\r\n    return this.currentMagazine\r\n  }\r\n\r\n  getReloadProgress(): number {\r\n    if (!this.reloading) return 1\r\n    return 1 - (this.reloadTimer / this.reloadTime)\r\n  }\r\n\r\n  takeDamage(amount: number): boolean {\r\n    if (this.invincible) return false\r\n\r\n    this.hp -= amount\r\n    if (this.hp <= 0) {\r\n      this.hp = 0\r\n      return true // Game over\r\n    }\r\n\r\n    // Start invincibility\r\n    this.invincible = true\r\n    this.invincibleTime = 2.0 // 2 seconds invincible\r\n\r\n    return false\r\n  }\r\n\r\n  heal(amount: number): void {\r\n    this.hp = Math.min(this.hp + amount, this.maxHp)\r\n  }\r\n\r\n  getPosition(): THREE.Vector3 {\r\n    return this.mesh.position.clone()\r\n  }\r\n\r\n  getMesh(): THREE.Mesh {\r\n    return this.mesh\r\n  }\r\n\r\n  getHP(): number {\r\n    return this.hp\r\n  }\r\n\r\n  getMaxHP(): number {\r\n    return this.maxHp\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\n\r\nexport class Bullet {\r\n  private mesh: THREE.Mesh\r\n  private speed: number = 80\r\n  private lifetime: number = 3.0\r\n  private age: number = 0\r\n  public active: boolean = true\r\n\r\n  constructor(scene: THREE.Scene, position: THREE.Vector3) {\r\n    this.mesh = this.createMesh()\r\n    this.mesh.position.copy(position)\r\n    scene.add(this.mesh)\r\n  }\r\n\r\n  private createMesh(): THREE.Mesh {\r\n    const geometry = new THREE.SphereGeometry(0.2, 8, 8)\r\n    const material = new THREE.MeshBasicMaterial({ color: 0xffff00 })\r\n    return new THREE.Mesh(geometry, material)\r\n  }\r\n\r\n  update(deltaTime: number): void {\r\n    this.mesh.position.z -= this.speed * deltaTime\r\n    this.age += deltaTime\r\n\r\n    if (this.age >= this.lifetime || this.mesh.position.z < -300) {\r\n      this.active = false\r\n    }\r\n  }\r\n\r\n  getPosition(): THREE.Vector3 {\r\n    return this.mesh.position.clone()\r\n  }\r\n\r\n  getMesh(): THREE.Mesh {\r\n    return this.mesh\r\n  }\r\n\r\n  destroy(scene: THREE.Scene): void {\r\n    scene.remove(this.mesh)\r\n    this.mesh.geometry.dispose()\r\n    const material = this.mesh.material\r\n    if (material instanceof THREE.Material) {\r\n      material.dispose()\r\n    }\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\n\r\nexport abstract class Enemy {\r\n  protected mesh: THREE.Mesh\r\n  protected hp: number\r\n  protected maxHp: number\r\n  protected speed: number = 20\r\n  public active: boolean = true\r\n\r\n  constructor(scene: THREE.Scene, position: THREE.Vector3, hp: number) {\r\n    this.hp = hp\r\n    this.maxHp = hp\r\n    this.mesh = this.createMesh()\r\n    this.mesh.position.copy(position)\r\n    scene.add(this.mesh)\r\n  }\r\n\r\n  protected abstract createMesh(): THREE.Mesh\r\n\r\n  abstract update(deltaTime: number, playerPos: THREE.Vector3): void\r\n\r\n  takeDamage(amount: number): boolean {\r\n    this.hp -= amount\r\n    if (this.hp <= 0) {\r\n      this.active = false\r\n      return true // Destroyed\r\n    }\r\n    return false\r\n  }\r\n\r\n  getPosition(): THREE.Vector3 {\r\n    return this.mesh.position.clone()\r\n  }\r\n\r\n  getMesh(): THREE.Mesh {\r\n    return this.mesh\r\n  }\r\n\r\n  destroy(scene: THREE.Scene): void {\r\n    scene.remove(this.mesh)\r\n    this.mesh.geometry.dispose()\r\n    const material = this.mesh.material\r\n    if (material instanceof THREE.Material) {\r\n      material.dispose()\r\n    }\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\nimport { Enemy } from './Enemy'\r\n\r\nexport class EnemyTypeA extends Enemy {\r\n  constructor(scene: THREE.Scene, position: THREE.Vector3) {\r\n    super(scene, position, 1)\r\n  }\r\n\r\n  protected createMesh(): THREE.Mesh {\r\n    const geometry = new THREE.TetrahedronGeometry(0.8)\r\n    const material = new THREE.MeshStandardMaterial({\r\n      color: 0xff0000,\r\n      flatShading: true\r\n    })\r\n    const mesh = new THREE.Mesh(geometry, material)\r\n    mesh.castShadow = true\r\n    return mesh\r\n  }\r\n\r\n  update(deltaTime: number, playerPos: THREE.Vector3): void {\r\n    // Straight movement towards player\r\n    this.mesh.position.z += this.speed * deltaTime\r\n\r\n    if (this.mesh.position.z > 20) {\r\n      this.active = false\r\n    }\r\n\r\n    this.mesh.rotation.y += deltaTime * 2\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\nimport { Enemy } from './Enemy'\r\n\r\nexport class EnemyTypeB extends Enemy {\r\n  private timeAlive: number = 0\r\n\r\n  constructor(scene: THREE.Scene, position: THREE.Vector3) {\r\n    super(scene, position, 2)\r\n  }\r\n\r\n  protected createMesh(): THREE.Mesh {\r\n    const geometry = new THREE.OctahedronGeometry(0.9)\r\n    const material = new THREE.MeshStandardMaterial({\r\n      color: 0xff6600,\r\n      flatShading: true\r\n    })\r\n    const mesh = new THREE.Mesh(geometry, material)\r\n    mesh.castShadow = true\r\n    return mesh\r\n  }\r\n\r\n  update(deltaTime: number, playerPos: THREE.Vector3): void {\r\n    this.timeAlive += deltaTime\r\n\r\n    // Sine wave movement (left-right)\r\n    const amplitude = 5\r\n    const frequency = 2\r\n    this.mesh.position.x = Math.sin(this.timeAlive * frequency) * amplitude\r\n\r\n    // Move forward\r\n    this.mesh.position.z += this.speed * deltaTime\r\n\r\n    if (this.mesh.position.z > 20) {\r\n      this.active = false\r\n    }\r\n\r\n    this.mesh.rotation.x += deltaTime * 2\r\n    this.mesh.rotation.y += deltaTime * 2\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\nimport { Enemy } from './Enemy'\r\n\r\nexport class EnemyTypeC extends Enemy {\r\n  private trackingSpeed: number = 3\r\n  private timeAlive: number = 0\r\n  private initialX: number\r\n  private zigzagAmplitude: number = 8\r\n  private zigzagFrequency: number = 1.5\r\n\r\n  constructor(scene: THREE.Scene, position: THREE.Vector3) {\r\n    super(scene, position, 3)\r\n    this.initialX = position.x\r\n  }\r\n\r\n  protected createMesh(): THREE.Mesh {\r\n    const geometry = new THREE.DodecahedronGeometry(1)\r\n    const material = new THREE.MeshStandardMaterial({\r\n      color: 0xff00ff,\r\n      flatShading: true\r\n    })\r\n    const mesh = new THREE.Mesh(geometry, material)\r\n    mesh.castShadow = true\r\n    return mesh\r\n  }\r\n\r\n  update(deltaTime: number, playerPos: THREE.Vector3): void {\r\n    this.timeAlive += deltaTime\r\n\r\n    // Zigzag pattern combined with gentle player tracking\r\n    const zigzagOffset = Math.sin(this.timeAlive * this.zigzagFrequency) * this.zigzagAmplitude\r\n    const targetX = this.initialX + zigzagOffset + (playerPos.x - this.mesh.position.x) * 0.2\r\n\r\n    // Slow tracking towards player Y position\r\n    const targetY = playerPos.y\r\n\r\n    this.mesh.position.x += (targetX - this.mesh.position.x) * this.trackingSpeed * deltaTime\r\n    this.mesh.position.y += (targetY - this.mesh.position.y) * this.trackingSpeed * deltaTime * 0.5\r\n\r\n    // Move forward\r\n    this.mesh.position.z += this.speed * deltaTime\r\n\r\n    if (this.mesh.position.z > 20) {\r\n      this.active = false\r\n    }\r\n\r\n    this.mesh.rotation.x += deltaTime * 3\r\n    this.mesh.rotation.y += deltaTime * 3\r\n    this.mesh.rotation.z += deltaTime * 3\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\n\r\nexport class Obstacle {\r\n  private mesh: THREE.Mesh\r\n  private speed: number = 20\r\n  public active: boolean = true\r\n\r\n  constructor(scene: THREE.Scene, position: THREE.Vector3, type: 'rock' | 'pillar' = 'rock') {\r\n    this.mesh = this.createMesh(type)\r\n    this.mesh.position.copy(position)\r\n    scene.add(this.mesh)\r\n  }\r\n\r\n  private createMesh(type: 'rock' | 'pillar'): THREE.Mesh {\r\n    let geometry: THREE.BufferGeometry\r\n\r\n    if (type === 'rock') {\r\n      geometry = new THREE.DodecahedronGeometry(1.5)\r\n    } else {\r\n      geometry = new THREE.CylinderGeometry(0.5, 0.5, 3, 6)\r\n    }\r\n\r\n    const material = new THREE.MeshStandardMaterial({\r\n      color: 0x808080,\r\n      flatShading: true\r\n    })\r\n\r\n    const mesh = new THREE.Mesh(geometry, material)\r\n    mesh.castShadow = true\r\n    return mesh\r\n  }\r\n\r\n  update(deltaTime: number): void {\r\n    // Move forward\r\n    this.mesh.position.z += this.speed * deltaTime\r\n\r\n    if (this.mesh.position.z > 20) {\r\n      this.active = false\r\n    }\r\n\r\n    // Slow rotation\r\n    this.mesh.rotation.y += deltaTime * 0.5\r\n  }\r\n\r\n  getPosition(): THREE.Vector3 {\r\n    return this.mesh.position.clone()\r\n  }\r\n\r\n  getMesh(): THREE.Mesh {\r\n    return this.mesh\r\n  }\r\n\r\n  destroy(scene: THREE.Scene): void {\r\n    scene.remove(this.mesh)\r\n    this.mesh.geometry.dispose()\r\n    const material = this.mesh.material\r\n    if (material instanceof THREE.Material) {\r\n      material.dispose()\r\n    }\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\n\r\nexport class CollisionDetector {\r\n  checkSphereCollision(\r\n    pos1: THREE.Vector3,\r\n    radius1: number,\r\n    pos2: THREE.Vector3,\r\n    radius2: number\r\n  ): boolean {\r\n    const distance = pos1.distanceTo(pos2)\r\n    return distance <= (radius1 + radius2)\r\n  }\r\n\r\n  checkBulletEnemyCollisions(bullets: any[], enemies: any[]): void {\r\n    for (const bullet of bullets) {\r\n      if (!bullet.active) continue\r\n\r\n      for (const enemy of enemies) {\r\n        if (!enemy.active) continue\r\n\r\n        if (this.checkSphereCollision(bullet.getPosition(), 0.2, enemy.getPosition(), 1)) {\r\n          bullet.active = false\r\n          enemy.takeDamage(1)\r\n          break\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  checkPlayerEnemyCollisions(playerPos: THREE.Vector3, enemies: any[]): boolean {\r\n    for (const enemy of enemies) {\r\n      if (!enemy.active) continue\r\n\r\n      if (this.checkSphereCollision(playerPos, 0.5, enemy.getPosition(), 1)) {\r\n        return true\r\n      }\r\n    }\r\n    return false\r\n  }\r\n\r\n  checkPlayerObstacleCollisions(playerPos: THREE.Vector3, obstacles: any[]): boolean {\r\n    for (const obstacle of obstacles) {\r\n      if (!obstacle.active) continue\r\n\r\n      if (this.checkSphereCollision(playerPos, 0.5, obstacle.getPosition(), 1)) {\r\n        return true\r\n      }\r\n    }\r\n    return false\r\n  }\r\n}\r\n","export class ScoreManager {\r\n  private score: number = 0\r\n  private highScore: number = 0\r\n  private readonly HIGHSCORE_KEY = '3d-stg-highscore'\r\n\r\n  constructor() {\r\n    this.loadHighScore()\r\n  }\r\n\r\n  addEnemyScore(enemyType: 'A' | 'B' | 'C'): void {\r\n    const scores = {\r\n      'A': 100,\r\n      'B': 200,\r\n      'C': 300\r\n    }\r\n    this.score += scores[enemyType]\r\n  }\r\n\r\n  addStageBonus(stage: number): void {\r\n    this.score += stage * 1000\r\n  }\r\n\r\n  getScore(): number {\r\n    return this.score\r\n  }\r\n\r\n  getHighScore(): number {\r\n    return this.highScore\r\n  }\r\n\r\n  saveHighScore(): void {\r\n    if (this.score > this.highScore) {\r\n      this.highScore = this.score\r\n      localStorage.setItem(this.HIGHSCORE_KEY, this.highScore.toString())\r\n    }\r\n  }\r\n\r\n  private loadHighScore(): void {\r\n    const saved = localStorage.getItem(this.HIGHSCORE_KEY)\r\n    if (saved) {\r\n      this.highScore = parseInt(saved, 10)\r\n    }\r\n  }\r\n\r\n  reset(): void {\r\n    this.score = 0\r\n  }\r\n}\r\n","export class HUD {\r\n  private hpDisplay: HTMLElement\r\n  private stageDisplay: HTMLElement\r\n  private scoreDisplay: HTMLElement\r\n\r\n  constructor() {\r\n    this.hpDisplay = document.getElementById('hp-display')!\r\n    this.stageDisplay = document.getElementById('stage-display')!\r\n    this.scoreDisplay = document.getElementById('score-display')!\r\n  }\r\n\r\n  updateHP(hp: number): void {\r\n    this.hpDisplay.textContent = `HP: ${hp}`\r\n  }\r\n\r\n  updateStage(stage: number): void {\r\n    this.stageDisplay.textContent = `STAGE ${stage}`\r\n  }\r\n\r\n  updateScore(score: number): void {\r\n    this.scoreDisplay.textContent = `SCORE: ${score}`\r\n  }\r\n\r\n  show(): void {\r\n    const hud = document.getElementById('hud')\r\n    if (hud) {\r\n      hud.style.display = 'block'\r\n    }\r\n  }\r\n\r\n  hide(): void {\r\n    const hud = document.getElementById('hud')\r\n    if (hud) {\r\n      hud.style.display = 'none'\r\n    }\r\n  }\r\n}\r\n","export class GameOverScreen {\r\n  private screen: HTMLElement\r\n  private finalScoreElement: HTMLElement\r\n  private finalStageElement: HTMLElement\r\n  private retryButton: HTMLElement\r\n\r\n  constructor(onRetry: () => void) {\r\n    this.screen = document.getElementById('game-over-screen')!\r\n    this.finalScoreElement = document.getElementById('final-score')!\r\n    this.finalStageElement = document.getElementById('final-stage')!\r\n    this.retryButton = document.getElementById('retry-button')!\r\n\r\n    this.retryButton.addEventListener('click', () => {\r\n      this.hide()\r\n      onRetry()\r\n    })\r\n  }\r\n\r\n  show(score: number, stage: number): void {\r\n    this.finalScoreElement.textContent = score.toString()\r\n    this.finalStageElement.textContent = stage.toString()\r\n    this.screen.style.display = 'block'\r\n  }\r\n\r\n  hide(): void {\r\n    this.screen.style.display = 'none'\r\n  }\r\n}\r\n","export class StageClearScreen {\r\n  private screen: HTMLElement\r\n\r\n  constructor(onNext: () => void) {\r\n    this.screen = this.createScreen()\r\n    document.body.appendChild(this.screen)\r\n\r\n    const nextButton = this.screen.querySelector('#next-stage-button') as HTMLElement\r\n    nextButton.addEventListener('click', () => {\r\n      this.hide()\r\n      onNext()\r\n    })\r\n  }\r\n\r\n  private createScreen(): HTMLElement {\r\n    const screen = document.createElement('div')\r\n    screen.id = 'stage-clear-screen'\r\n    screen.style.cssText = `\r\n      position: absolute;\r\n      top: 50%;\r\n      left: 50%;\r\n      transform: translate(-50%, -50%);\r\n      text-align: center;\r\n      color: white;\r\n      background: rgba(0, 0, 0, 0.8);\r\n      padding: 40px;\r\n      border-radius: 10px;\r\n      display: none;\r\n      z-index: 100;\r\n    `\r\n\r\n    screen.innerHTML = `\r\n      <h1 style=\"font-size: 48px; margin-bottom: 20px; color: #00ff00;\">STAGE CLEAR!</h1>\r\n      <p style=\"font-size: 24px; margin: 10px 0;\">Stage: <span id=\"cleared-stage\">1</span></p>\r\n      <p style=\"font-size: 24px; margin: 10px 0;\">Score: <span id=\"cleared-score\">0</span></p>\r\n      <p style=\"font-size: 20px; margin: 10px 0;\">Stage Bonus: <span id=\"stage-bonus\">1000</span></p>\r\n      <button id=\"next-stage-button\" style=\"\r\n        margin-top: 20px;\r\n        padding: 15px 30px;\r\n        font-size: 20px;\r\n        background: #00ff00;\r\n        color: black;\r\n        border: none;\r\n        border-radius: 5px;\r\n        cursor: pointer;\r\n        font-weight: bold;\r\n      \">NEXT STAGE</button>\r\n    `\r\n\r\n    return screen\r\n  }\r\n\r\n  show(stage: number, score: number, bonus: number): void {\r\n    const clearedStage = this.screen.querySelector('#cleared-stage') as HTMLElement\r\n    const clearedScore = this.screen.querySelector('#cleared-score') as HTMLElement\r\n    const stageBonus = this.screen.querySelector('#stage-bonus') as HTMLElement\r\n    const nextButton = this.screen.querySelector('#next-stage-button') as HTMLElement\r\n\r\n    clearedStage.textContent = stage.toString()\r\n    clearedScore.textContent = score.toString()\r\n    stageBonus.textContent = bonus.toString()\r\n\r\n    // Change button text for final stage\r\n    if (stage >= 5) {\r\n      nextButton.textContent = 'GAME COMPLETE!'\r\n    } else {\r\n      nextButton.textContent = 'NEXT STAGE'\r\n    }\r\n\r\n    this.screen.style.display = 'block'\r\n  }\r\n\r\n  hide(): void {\r\n    this.screen.style.display = 'none'\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\nimport { StageConfig, WavePattern } from '../types'\r\n\r\nexport const STAGE_DATA: StageConfig[] = [\r\n  // Stage 1: Tutorial - Easy\r\n  {\r\n    stageNumber: 1,\r\n    enemySpawnInterval: 2.5,\r\n    obstacleSpawnInterval: 5.0,\r\n    backgroundColor: 0x87CEEB, // Sky blue\r\n    groundColors: { color1: '#00ff00', color2: '#00aa00' },\r\n    waves: [\r\n      {\r\n        enemyType: 'A',\r\n        positions: [\r\n          new THREE.Vector3(0, 0, -100),\r\n          new THREE.Vector3(-5, 2, -110),\r\n          new THREE.Vector3(5, 2, -110)\r\n        ],\r\n        spawnDelay: 1.0\r\n      }\r\n    ]\r\n  },\r\n\r\n  // Stage 2: Moderate difficulty\r\n  {\r\n    stageNumber: 2,\r\n    enemySpawnInterval: 2.0,\r\n    obstacleSpawnInterval: 4.5,\r\n    backgroundColor: 0xFF6347, // Tomato\r\n    groundColors: { color1: '#ff8800', color2: '#cc6600' },\r\n    waves: [\r\n      {\r\n        enemyType: 'B',\r\n        positions: [\r\n          new THREE.Vector3(-8, 0, -100),\r\n          new THREE.Vector3(0, 3, -105),\r\n          new THREE.Vector3(8, 0, -100)\r\n        ],\r\n        spawnDelay: 1.5\r\n      }\r\n    ]\r\n  },\r\n\r\n  // Stage 3: Increased difficulty\r\n  {\r\n    stageNumber: 3,\r\n    enemySpawnInterval: 1.8,\r\n    obstacleSpawnInterval: 4.0,\r\n    backgroundColor: 0x9370DB, // Medium purple\r\n    groundColors: { color1: '#ff00ff', color2: '#aa00aa' },\r\n    waves: [\r\n      {\r\n        enemyType: 'C',\r\n        positions: [\r\n          new THREE.Vector3(-10, -2, -100),\r\n          new THREE.Vector3(10, -2, -100),\r\n          new THREE.Vector3(0, 5, -95)\r\n        ],\r\n        spawnDelay: 1.2\r\n      }\r\n    ]\r\n  },\r\n\r\n  // Stage 4: Hard\r\n  {\r\n    stageNumber: 4,\r\n    enemySpawnInterval: 1.5,\r\n    obstacleSpawnInterval: 3.5,\r\n    backgroundColor: 0xFF1493, // Deep pink\r\n    groundColors: { color1: '#ff0000', color2: '#aa0000' },\r\n    waves: [\r\n      {\r\n        enemyType: 'A',\r\n        positions: [\r\n          new THREE.Vector3(-8, 0, -100),\r\n          new THREE.Vector3(-4, 3, -105),\r\n          new THREE.Vector3(0, -3, -100),\r\n          new THREE.Vector3(4, 3, -105),\r\n          new THREE.Vector3(8, 0, -100)\r\n        ],\r\n        spawnDelay: 1.0\r\n      }\r\n    ]\r\n  },\r\n\r\n  // Stage 5: Final stage - Very hard\r\n  {\r\n    stageNumber: 5,\r\n    enemySpawnInterval: 1.2,\r\n    obstacleSpawnInterval: 3.0,\r\n    backgroundColor: 0x000080, // Navy\r\n    groundColors: { color1: '#0000ff', color2: '#0000aa' },\r\n    waves: [\r\n      {\r\n        enemyType: 'C',\r\n        positions: [\r\n          new THREE.Vector3(-10, 5, -100),\r\n          new THREE.Vector3(-5, -5, -95),\r\n          new THREE.Vector3(0, 0, -105),\r\n          new THREE.Vector3(5, -5, -95),\r\n          new THREE.Vector3(10, 5, -100)\r\n        ],\r\n        spawnDelay: 0.8\r\n      }\r\n    ]\r\n  }\r\n]\r\n\r\nexport function getStageConfig(stageNumber: number): StageConfig {\r\n  const index = stageNumber - 1\r\n  if (index >= 0 && index < STAGE_DATA.length) {\r\n    return STAGE_DATA[index]\r\n  }\r\n  // Return last stage if beyond max\r\n  return STAGE_DATA[STAGE_DATA.length - 1]\r\n}\r\n","import * as THREE from 'three'\r\nimport { SceneManager } from '../scene/SceneManager'\r\nimport { Background } from '../scene/Background'\r\nimport { InputManager } from '../input/InputManager'\r\nimport { Player } from './Player'\r\nimport { Bullet } from './Bullet'\r\nimport { Enemy } from './Enemy'\r\nimport { EnemyTypeA } from './EnemyTypeA'\r\nimport { EnemyTypeB } from './EnemyTypeB'\r\nimport { EnemyTypeC } from './EnemyTypeC'\r\nimport { Obstacle } from './Obstacle'\r\nimport { CollisionDetector } from '../utils/CollisionDetector'\r\nimport { ScoreManager } from '../utils/ScoreManager'\r\nimport { HUD } from '../ui/HUD'\r\nimport { GameOverScreen } from '../ui/GameOverScreen'\r\nimport { StageClearScreen } from '../ui/StageClearScreen'\r\nimport { getStageConfig } from './StageData'\r\n\r\nexport class Game {\r\n  private sceneManager: SceneManager\r\n  private inputManager: InputManager\r\n  private player: Player\r\n  private enemies: Enemy[] = []\r\n  private bullets: Bullet[] = []\r\n  private obstacles: Obstacle[] = []\r\n  private background: Background\r\n  private hud: HUD\r\n  private gameOverScreen: GameOverScreen\r\n  private stageClearScreen: StageClearScreen\r\n  private collisionDetector: CollisionDetector\r\n  private scoreManager: ScoreManager\r\n  private clock: THREE.Clock\r\n  private gameState: 'playing' | 'gameover' | 'stageclear' = 'playing'\r\n  private currentStage: number = 1\r\n  private maxBullets: number = 5\r\n\r\n  // Enemy spawning\r\n  private enemySpawnTimer: number = 0\r\n  private enemySpawnInterval: number = 2.0\r\n  private obstacleSpawnTimer: number = 0\r\n  private obstacleSpawnInterval: number = 4.0\r\n\r\n  // Stage clear tracking\r\n  private enemiesKilledThisStage: number = 0\r\n  private enemiesNeededForClear: number = 20\r\n\r\n  constructor() {\r\n    this.sceneManager = new SceneManager()\r\n    this.inputManager = new InputManager()\r\n    this.collisionDetector = new CollisionDetector()\r\n    this.scoreManager = new ScoreManager()\r\n    this.clock = new THREE.Clock()\r\n    this.background = new Background(this.sceneManager.getScene())\r\n    this.player = new Player(this.sceneManager.getScene())\r\n    this.hud = new HUD()\r\n    this.gameOverScreen = new GameOverScreen(() => this.restart())\r\n    this.stageClearScreen = new StageClearScreen(() => this.nextStage())\r\n\r\n    this.loadStage(1)\r\n    this.hud.show()\r\n    this.hud.updateScore(this.scoreManager.getScore())\r\n    this.gameLoop()\r\n  }\r\n\r\n  private gameLoop = (): void => {\r\n    requestAnimationFrame(this.gameLoop)\r\n\r\n    const deltaTime = this.clock.getDelta()\r\n\r\n    if (this.gameState === 'playing') {\r\n      this.update(deltaTime)\r\n    }\r\n\r\n    this.sceneManager.render()\r\n  }\r\n\r\n  private update(deltaTime: number): void {\r\n    const input = this.inputManager.getInputState()\r\n\r\n    // Update player\r\n    this.player.update(deltaTime, input)\r\n\r\n    // Shooting (removed bullet count limit)\r\n    if (input.shoot && this.player.canShoot()) {\r\n      const bullet = new Bullet(this.sceneManager.getScene(), this.player.getPosition())\r\n      this.bullets.push(bullet)\r\n      this.player.resetShootCooldown()\r\n    }\r\n\r\n    // Update bullets\r\n    for (const bullet of this.bullets) {\r\n      bullet.update(deltaTime)\r\n    }\r\n\r\n    // Remove inactive bullets\r\n    this.bullets = this.bullets.filter(bullet => {\r\n      if (!bullet.active) {\r\n        bullet.destroy(this.sceneManager.getScene())\r\n        return false\r\n      }\r\n      return true\r\n    })\r\n\r\n    // Update enemies\r\n    const playerPos = this.player.getPosition()\r\n    for (const enemy of this.enemies) {\r\n      enemy.update(deltaTime, playerPos)\r\n    }\r\n\r\n    // Remove inactive enemies\r\n    this.enemies = this.enemies.filter(enemy => {\r\n      if (!enemy.active) {\r\n        enemy.destroy(this.sceneManager.getScene())\r\n        return false\r\n      }\r\n      return true\r\n    })\r\n\r\n    // Update obstacles\r\n    for (const obstacle of this.obstacles) {\r\n      obstacle.update(deltaTime)\r\n    }\r\n\r\n    // Remove inactive obstacles\r\n    this.obstacles = this.obstacles.filter(obstacle => {\r\n      if (!obstacle.active) {\r\n        obstacle.destroy(this.sceneManager.getScene())\r\n        return false\r\n      }\r\n      return true\r\n    })\r\n\r\n    // Update background\r\n    this.background.update(deltaTime)\r\n\r\n    // Collision detection - bullets vs enemies\r\n    for (const bullet of this.bullets) {\r\n      if (!bullet.active) continue\r\n\r\n      for (const enemy of this.enemies) {\r\n        if (!enemy.active) continue\r\n\r\n        // Increased collision radius for better hit detection\r\n        if (this.collisionDetector.checkSphereCollision(bullet.getPosition(), 0.5, enemy.getPosition(), 1.5)) {\r\n          bullet.active = false\r\n          const destroyed = enemy.takeDamage(1)\r\n          if (destroyed) {\r\n            // Add score based on enemy type\r\n            const enemyType = this.getEnemyType(enemy)\r\n            this.scoreManager.addEnemyScore(enemyType)\r\n            this.hud.updateScore(this.scoreManager.getScore())\r\n            this.enemiesKilledThisStage++\r\n\r\n            // Check stage clear\r\n            if (this.enemiesKilledThisStage >= this.enemiesNeededForClear) {\r\n              this.handleStageClear()\r\n            }\r\n          }\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    // Collision detection - bullets vs obstacles\r\n    for (const bullet of this.bullets) {\r\n      if (!bullet.active) continue\r\n\r\n      for (const obstacle of this.obstacles) {\r\n        if (!obstacle.active) continue\r\n\r\n        if (this.collisionDetector.checkSphereCollision(bullet.getPosition(), 0.5, obstacle.getPosition(), 2.0)) {\r\n          bullet.active = false\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    // Player vs enemies\r\n    if (this.collisionDetector.checkPlayerEnemyCollisions(playerPos, this.enemies)) {\r\n      const gameOver = this.player.takeDamage(1)\r\n      this.hud.updateHP(this.player.getHP())\r\n      if (gameOver) {\r\n        this.handleGameOver()\r\n      }\r\n    }\r\n\r\n    // Player vs obstacles\r\n    if (this.collisionDetector.checkPlayerObstacleCollisions(playerPos, this.obstacles)) {\r\n      const gameOver = this.player.takeDamage(1)\r\n      this.hud.updateHP(this.player.getHP())\r\n      if (gameOver) {\r\n        this.handleGameOver()\r\n      }\r\n    }\r\n\r\n    // Spawn enemies\r\n    this.enemySpawnTimer += deltaTime\r\n    if (this.enemySpawnTimer >= this.enemySpawnInterval) {\r\n      this.spawnEnemy()\r\n      this.enemySpawnTimer = 0\r\n    }\r\n\r\n    // Spawn obstacles\r\n    this.obstacleSpawnTimer += deltaTime\r\n    if (this.obstacleSpawnTimer >= this.obstacleSpawnInterval) {\r\n      this.spawnObstacle()\r\n      this.obstacleSpawnTimer = 0\r\n    }\r\n  }\r\n\r\n  private getEnemyType(enemy: Enemy): 'A' | 'B' | 'C' {\r\n    if (enemy instanceof EnemyTypeA) return 'A'\r\n    if (enemy instanceof EnemyTypeB) return 'B'\r\n    if (enemy instanceof EnemyTypeC) return 'C'\r\n    return 'A'\r\n  }\r\n\r\n  private spawnEnemy(): void {\r\n    const x = THREE.MathUtils.randFloat(-10, 10)\r\n    const y = THREE.MathUtils.randFloat(-5, 5)\r\n    const z = -100\r\n\r\n    const enemyType = Math.floor(Math.random() * 3)\r\n    let enemy: Enemy\r\n\r\n    switch (enemyType) {\r\n      case 0:\r\n        enemy = new EnemyTypeA(this.sceneManager.getScene(), new THREE.Vector3(x, y, z))\r\n        break\r\n      case 1:\r\n        enemy = new EnemyTypeB(this.sceneManager.getScene(), new THREE.Vector3(x, y, z))\r\n        break\r\n      case 2:\r\n        enemy = new EnemyTypeC(this.sceneManager.getScene(), new THREE.Vector3(x, y, z))\r\n        break\r\n      default:\r\n        enemy = new EnemyTypeA(this.sceneManager.getScene(), new THREE.Vector3(x, y, z))\r\n    }\r\n\r\n    this.enemies.push(enemy)\r\n  }\r\n\r\n  private spawnObstacle(): void {\r\n    const x = THREE.MathUtils.randFloat(-10, 10)\r\n    const y = THREE.MathUtils.randFloat(-3, 3)\r\n    const z = -100\r\n    const type = Math.random() > 0.5 ? 'rock' : 'pillar'\r\n\r\n    const obstacle = new Obstacle(this.sceneManager.getScene(), new THREE.Vector3(x, y, z), type)\r\n    this.obstacles.push(obstacle)\r\n  }\r\n\r\n  private loadStage(stageNumber: number): void {\r\n    const stageConfig = getStageConfig(stageNumber)\r\n    this.currentStage = stageNumber\r\n    this.enemySpawnInterval = stageConfig.enemySpawnInterval\r\n    this.obstacleSpawnInterval = stageConfig.obstacleSpawnInterval\r\n    this.enemiesKilledThisStage = 0\r\n\r\n    // Update background colors\r\n    this.background.updateGroundColors(stageConfig.groundColors.color1, stageConfig.groundColors.color2)\r\n\r\n    // Update HUD\r\n    this.hud.updateStage(stageNumber)\r\n  }\r\n\r\n  private handleStageClear(): void {\r\n    this.gameState = 'stageclear'\r\n    const bonus = this.currentStage * 1000\r\n    this.scoreManager.addStageBonus(this.currentStage)\r\n    this.hud.updateScore(this.scoreManager.getScore())\r\n    this.stageClearScreen.show(this.currentStage, this.scoreManager.getScore(), bonus)\r\n  }\r\n\r\n  private nextStage(): void {\r\n    if (this.currentStage >= 5) {\r\n      // Game complete\r\n      this.scoreManager.saveHighScore()\r\n      this.handleGameOver()\r\n    } else {\r\n      this.currentStage++\r\n      this.loadStage(this.currentStage)\r\n      this.gameState = 'playing'\r\n      this.clock.getDelta() // Reset delta\r\n    }\r\n  }\r\n\r\n  private handleGameOver(): void {\r\n    this.gameState = 'gameover'\r\n    this.scoreManager.saveHighScore()\r\n    this.gameOverScreen.show(this.scoreManager.getScore(), this.currentStage)\r\n  }\r\n\r\n  private restart(): void {\r\n    // Clear all entities\r\n    for (const bullet of this.bullets) {\r\n      bullet.destroy(this.sceneManager.getScene())\r\n    }\r\n    for (const enemy of this.enemies) {\r\n      enemy.destroy(this.sceneManager.getScene())\r\n    }\r\n    for (const obstacle of this.obstacles) {\r\n      obstacle.destroy(this.sceneManager.getScene())\r\n    }\r\n\r\n    this.bullets = []\r\n    this.enemies = []\r\n    this.obstacles = []\r\n\r\n    // Reset player\r\n    this.player.getMesh().removeFromParent()\r\n    this.player = new Player(this.sceneManager.getScene())\r\n\r\n    // Reset game state\r\n    this.scoreManager.reset()\r\n    this.currentStage = 1\r\n    this.gameState = 'playing'\r\n    this.enemySpawnTimer = 0\r\n    this.obstacleSpawnTimer = 0\r\n    this.enemiesKilledThisStage = 0\r\n\r\n    // Load stage 1\r\n    this.loadStage(1)\r\n\r\n    // Update HUD\r\n    this.hud.updateHP(this.player.getHP())\r\n    this.hud.updateScore(this.scoreManager.getScore())\r\n\r\n    this.clock.getDelta()\r\n  }\r\n}\r\n","import { Game } from './game/Game'\r\n\r\n// Initialize game when DOM is loaded\r\nwindow.addEventListener('DOMContentLoaded', () => {\r\n  new Game()\r\n})\r\n"],"names":["SceneManager","THREE.Scene","camera","THREE.PerspectiveCamera","renderer","THREE.WebGLRenderer","THREE.PCFSoftShadowMap","container","ambientLight","THREE.AmbientLight","directionalLight","THREE.DirectionalLight","Background","scene","color1","color2","geometry","THREE.PlaneGeometry","ctx","tileSize","y","x","texture","THREE.CanvasTexture","THREE.RepeatWrapping","material","THREE.MeshStandardMaterial","THREE.DoubleSide","ground","THREE.Mesh","THREE.BufferGeometry","vertices","i","THREE.MathUtils","THREE.Float32BufferAttribute","THREE.PointsMaterial","THREE.Points","deltaTime","InputManager","touch","state","Player","THREE.ConeGeometry","mesh","input","targetX","targetY","amount","Bullet","position","THREE.SphereGeometry","THREE.MeshBasicMaterial","THREE.Material","Enemy","hp","EnemyTypeA","THREE.TetrahedronGeometry","playerPos","EnemyTypeB","THREE.OctahedronGeometry","amplitude","frequency","EnemyTypeC","THREE.DodecahedronGeometry","zigzagOffset","Obstacle","type","THREE.CylinderGeometry","CollisionDetector","pos1","radius1","pos2","radius2","bullets","enemies","bullet","enemy","obstacles","obstacle","ScoreManager","enemyType","scores","stage","saved","HUD","score","hud","GameOverScreen","onRetry","StageClearScreen","onNext","screen","bonus","clearedStage","clearedScore","stageBonus","nextButton","STAGE_DATA","THREE.Vector3","getStageConfig","stageNumber","index","Game","THREE.Clock","gameOver","z","stageConfig"],"mappings":"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"}